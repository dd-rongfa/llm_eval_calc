# 测试大模型的基础计算能力
## 流程： 
#### 1 测试集构建，

自动化生成工具开发  
基于约束的题目生成器（控制位数，运算类型，进位次数）  
答案验证模块（支持大数运算的，精准库）

测试样例设计：
- 基础组（无进位简单计算）
- 压力测试组（连续进位）
- 混合运算组（含多个运算符的复合表达式）
- 做其他任务是，穿插计算任务 看是否有影响 

数据规模：每层100个样例

#### 2 实验方案执行，

标准化测试流程：
- 温度为0，
- 统一prompt模板
    systemp_prompt = ''
    quetion = f"请准确计算 {num1}+{num2}，把最终计算结果放 \\boxed{{}} 中，例如计算结果为2, 写成 \\boxed{{2}}"
- 超时和重试
     火山引擎 批量推理，超时时间设定20分钟，response code为 500和429 则等待60s后重试。

- 字符解析错误的处理  
     需要写入csv，防止其他问题 

错误类型标注体系
-----------------

1. 位数错误 
2. 单数字符错误
3. 进位错误
3.1 遗漏进位
3.2 错误进位
3.3 重复进位

-------------------
#### 3 数据分析

量化分析：
准确度随位数变化  降低
错误类型哪个分布 
模型间表现
可视化呈现
位数-准确度曲线
热力图和错误类型
模型对比

无进位数据情况：    

deepseek 错误分析：
计算错误类型：   
- 可能发生虚空进位：列竖直时，提取结果时都可能发生   
- 可能发生部分数字错位  由于没有进位（数字顺序不同，会有相同部分，通过字符比较就可以发现）   
- - 连续数字错位（常见），产生了
        12和21   34和43 67换76  89和98  相差9   
        13和31   46和64  差18   
        14和41   36和63  差27  
        15和51   37和73  差36  
        16和61   38和83  差45  
        17和71   39和93  差54  
        18和81           差63   
- - 多个数字对调（少见）   
        785和578   

备注：
考虑通过修改提示词，明确要求列竖式计算，计算结果以竖直结果为准。？
Claude-3.7-Sonnet(Poe) 会发生列竖式错误，但结果正确，怀疑式调用了计算工具。

#### 4 专业成输出

- 技术报告撰写
- 开源项目构建github

#### 消融实验：
- 不同prompt对准确性的影响
- cot是否改善二零计算的准确性
- 模型规模和计算能力的相关性


#### 相关资料

给数字引入单的位置编码（Abacus Embedding 算盘）
[Transformers Can Do Arithmetic with the Right Embeddings](https://arxiv.org/abs/2405.17399)

知乎话题  
[LLM（大语言模型）无法对数字进行准确运算的底层原因是什么？ - 张俊林的回答 - 知乎](https://www.zhihu.com/question/654932431/answer/3522356508)